<?php
  $i = 0;
?>
<div class="products-container">
  <?php forEach($this -> vars['products'] as $product){ ?>
  <div class="row">
  
    <div class="col-xs-8 col-sm-4">
      <label><small><?php echo $product -> product_sku; ?></small></label>
      <input
        readonly
        type="text"
        class="form-control"
        name="product_name"
        value="<?php echo $product -> product_name; ?>"
        required>
      <input
        type="hidden"
        class="form-control id-product-order"
        name="Orders[products][<?php echo $i; ?>][product_id]"
        value="<?php echo $product -> pivot -> product_id; ?>"
        required>
    </div>
  
    <div class="col-xs-4 col-sm-2 col-md-2 text-center">
      <label>Costo</label>
      <input
        readonly
        type="text"
        class="form-control text-center"
        id="price-<?php echo $i;?>"
        name="product_price"
        value="<?php echo $product -> product_price; ?>"
        required>
    </div>
  
    <div class="col-xs-3 col-sm-2 col-md-2 text-center">
      <label>Cantidad</label>
      <input
        onchange="updateTotalSubtotalOrder('<?php echo $i; ?>')"
        type="number"
        step="any"
        name="Orders[products][<?php echo $i; ?>][quantity]"
        id="quantity-<?php echo $i; ?>"
        value="<?php echo $product -> pivot -> quantity; ?>"
        placeholder=""
        min="1"
        class="form-control text-center p-0"
        autocomplete="off"
        pattern="-?\d+(\.\d+)?"
        maxlength="255"
        required="true">
    </div>
  
    <div class="col-xs-4 col-sm-2 col-md-2 text-center">
      <label>Subtotal</label>
      <input
        readonly
        type="number"
        name="subtotal"
        id="subtotal-<?php echo $i; ?>"
        value="<?php echo $product -> pivot -> quantity * $product -> product_price; ?>"
        class="form-control text-center subtotal-items"
        required="true">
    </div>

    <div class="col-xs-5 col-sm-2 text-center">
      <div>
        <label>Acciones</label>
      </div>
      <button type="button" class="btn btn-info btn-sm" onclick="getProductData('<?php echo $product -> id?>')">
        <i class="icon icon-eye"></i>
      </button>
      <button onclick="detachOrderProduct('<?php echo $product -> pivot -> product_id; ?>', '<?php echo $product -> pivot -> order_id; ?>')" type="button" class="btn btn-danger btn-sm">
        <i class="icon icon-times"></i>
      </button>
    </div>

  </div>
    
  <hr style="border: solid 1px rgb(202, 200, 200); width: 100%;">
  <?php $i++ ?>
  <?php } ?>
</div>

<?php include '_product-browser.htm' ?>

<div class="text-center" style="margin-top:10px;">
  <button type="button" onclick="toggleNewProduct(true)" id="add-product-quotation" class="btn btn-info">
    Agregar Producto
  </button>
  <button type="button" onclick="toggleNewProduct(false)" id="cancel-add-product-quotation" class="btn btn-danger">
    Cancelar
  </button>
</div>

<?php include '_popproduct.htm' ?>